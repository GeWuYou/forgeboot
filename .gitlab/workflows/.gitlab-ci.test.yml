stages:
  - publish

# ğŸ§ª test å‘å¸ƒ SNAPSHOT åŒ…ï¼ˆå…è®¸è¦†ç›–ï¼‰
publish:
  stage: publish
  rules:
    - if: '$CI_COMMIT_BRANCH == "test" && ($CI_PIPELINE_SOURCE == "push" || $CI_PIPELINE_SOURCE == "merge_request_event")'
  script:
    - echo "ğŸ”§ æˆäºˆ gradlew æ‰§è¡Œæƒé™..."
    - chmod +x gradlew
    # å¼ºåˆ¶åˆ·æ–° SNAPSHOT ç¼“å­˜å¹¶å‘å¸ƒ
    - ./gradlew clean publishMavenJavaPublicationToGitLabRepository \
      --no-daemon \
      --refresh-dependencies \
      -Porg.gradle.caching=false \
      -Dorg.gradle.configuration-cache=false
  tags:
    - java
